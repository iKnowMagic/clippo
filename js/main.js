// koffee 1.4.0

/*
00     00   0000000   000  000   000
000   000  000   000  000  0000  000
000000000  000000000  000  000 0 000
000 0 000  000   000  000  000  0000
000   000  000   000  000  000   000
 */
var _, activeApp, app, appIconSync, appName, buffers, childp, clearBuffer, clipboard, clippoWatch, copyIndex, deleteIndex, electron, empty, first, fs, getActiveApp, iconDir, kerror, macClipboardChanged, nativeImage, noon, onClipboardChanged, onWillShowWin, originApp, os, osascript, pasteIndex, pkg, post, prefs, quit, readBuffer, ref, reload, saveAppIcon, saveBuffer, slash, watchClipboard, winClipboardChanged;

ref = require('kxk'), post = ref.post, osascript = ref.osascript, childp = ref.childp, first = ref.first, slash = ref.slash, prefs = ref.prefs, empty = ref.empty, noon = ref.noon, app = ref.app, os = ref.os, fs = ref.fs, kerror = ref.kerror, _ = ref._;

electron = require('electron');

pkg = require('../package.json');

if (os.platform() === 'darwin') {
    appIconSync = require('./appiconsync');
}

app = new app({
    dir: __dirname,
    pkg: pkg,
    shortcut: 'CmdOrCtrl+Alt+V',
    index: 'index.html',
    icon: '../img/app.ico',
    tray: '../img/menu@2x.png',
    about: '../img/about.png',
    onQuit: function() {
        return quit();
    },
    onWillShowWin: function() {
        return onWillShowWin();
    },
    width: 1000,
    height: 1200,
    minWidth: 300,
    minHeight: 200
});

clipboard = electron.clipboard;

nativeImage = electron.nativeImage;

buffers = [];

iconDir = "";

activeApp = "";

originApp = null;

clippoWatch = null;

appName = 'clippo';

post.on('paste', function(index) {
    return pasteIndex(index);
});

post.on('del', function(index) {
    return deleteIndex(index);
});

post.onGet('buffers', function() {
    return buffers;
});

post.on('clearBuffer', function() {
    return clearBuffer();
});

post.on('saveBuffer', function() {
    return saveBuffer();
});

getActiveApp = function() {
    var info, script, wxw;
    if (os.platform() === 'win32') {
        wxw = require('wxw');
        info = first(wxw('info', 'top'));
        appName = slash.base(info.path);
    } else if (os.platform() === 'darwin') {
        script = osascript("tell application \"System Events\"\n    set n to name of first application process whose frontmost is true\nend tell\ndo shell script \"echo \" & n");
        appName = childp.execSync("osascript " + script);
        appName = String(appName).trim();
    }
    return appName;
};

saveAppIcon = function(appName) {
    var iconPath, png;
    iconPath = iconDir + "/" + appName + ".png";
    if (!slash.isFile(iconPath)) {
        png = appIconSync(appName, iconDir, 128);
        if (!png) {
            appName = "clippo";
        }
    }
    return appName;
};

onWillShowWin = function() {
    return activeApp = getActiveApp();
};

winClipboardChanged = function() {
    var exapp, exclude, i, iconPath, len, winInfo, wxw;
    wxw = require('wxw');
    appName = 'clippo';
    winInfo = first(wxw('info', 'top'));
    appName = slash.base(winInfo.path);
    exclude = prefs.get('exclude', ['password-turtle']);
    if (!empty(exclude)) {
        for (i = 0, len = exclude.length; i < len; i++) {
            exapp = exclude[i];
            if (appName.startsWith(exapp)) {
                return;
            }
        }
    }
    iconPath = iconDir + "/" + appName + ".png";
    if (!slash.isFile(iconPath)) {
        wxw('icon', winInfo.path, iconPath);
    }
    return onClipboardChanged();
};

macClipboardChanged = function() {
    var currentApp;
    currentApp = getActiveApp();
    if (currentApp.toLowerCase() === 'electron') {
        currentApp = 'clippo';
    }
    if ((!originApp) && (!currentApp)) {
        originApp = 'clippo';
    }
    saveAppIcon(originApp != null ? originApp : currentApp);
    return onClipboardChanged();
};

onClipboardChanged = function() {
    var b, format, i, imageBuffer, imageData, j, k, len, len1, len2, ref1, text;
    ref1 = clipboard.availableFormats();
    for (i = 0, len = ref1.length; i < len; i++) {
        format = ref1[i];
        if (format.startsWith('image/')) {
            imageBuffer = clipboard.readImage().toPNG();
            imageData = imageBuffer.toString('base64');
            for (j = 0, len1 = buffers.length; j < len1; j++) {
                b = buffers[j];
                if ((b.image != null) && b.image === imageData) {
                    appName = b.app;
                    _.pull(buffers, b);
                    break;
                }
            }
            buffers.push({
                app: appName,
                image: imageData,
                count: buffers.length
            });
            reload(buffers.length - 1);
            return;
        }
    }
    text = clipboard.readText();
    if (text.length && text.trim().length) {
        for (k = 0, len2 = buffers.length; k < len2; k++) {
            b = buffers[k];
            if ((b.text != null) && b.text === text) {
                appName = b.app;
                _.pull(buffers, b);
                break;
            }
        }
        buffers.push({
            app: appName,
            text: text,
            count: buffers.length - 1
        });
        return reload(buffers.length - 1);
    }
};

watchClipboard = function() {
    var cw;
    cw = require('electron-clipboard-watcher');
    if (os.platform() === 'win32') {
        return cw({
            watchDelay: 200,
            onImageChange: winClipboardChanged,
            onTextChange: winClipboardChanged
        });
    } else {
        return cw({
            watchDelay: 200,
            onImageChange: macClipboardChanged,
            onTextChange: macClipboardChanged
        });
    }
};

copyIndex = function(index) {
    var image;
    if ((index < 0) || (index > buffers.length - 1)) {
        return;
    }
    if (buffers[index].image) {
        image = nativeImage.createFromBuffer(new Buffer(buffers[index].image, 'base64'));
        if (!image.isEmpty() && (image.getSize().width * image.getSize().height > 0)) {
            clipboard.writeImage(image, 'image/png');
        }
    }
    if ((buffers[index].text != null) && (buffers[index].text.length > 0)) {
        return clipboard.writeText(buffers[index].text, 'text/plain');
    }
};

pasteIndex = function(index) {
    var paste, ref1, wxw;
    copyIndex(index);
    originApp = (ref1 = buffers.splice(index, 1)[0]) != null ? ref1.app : void 0;
    if (os.platform() === 'win32') {
        wxw = require('wxw');
        paste = function() {
            if (activeApp === 'mintty') {
                return wxw('key', 'ctrl+shift+v');
            } else {
                return wxw('key', 'ctrl+v');
            }
        };
        app.win.close();
        return setTimeout(paste, 20);
    } else if (os.platform() !== 'darwin') {
        childp.execSync("osascript " + osascript("tell application \"System Events\" to keystroke tab using command down"));
        return childp.execSync("osascript " + osascript("tell application \"System Events\" to keystroke \"v\" using command down"));
    }
};

deleteIndex = function(index) {
    buffers.splice(index, 1);
    return reload(index - 1);
};

quit = function() {
    saveBuffer();
    return clippoWatch != null ? clippoWatch.kill() : void 0;
};

reload = function(index) {
    if (index == null) {
        index = 0;
    }
    return post.toWins('loadBuffers', buffers, index);
};

clearBuffer = function() {
    buffers = [];
    saveBuffer();
    return reload();
};

saveBuffer = function() {
    return noon.save(app.userData + "/buffers.noon", buffers.slice(-prefs.get('maxBuffers', 50)));
};

readBuffer = function() {
    try {
        buffers = noon.load(slash.path(app.userData + "/buffers.noon"));
        return buffers = buffers != null ? buffers : [];
    } catch (error) {
        return buffers = [];
    }
};

post.on('appReady', function() {
    var err;
    readBuffer();
    iconDir = slash.resolve(app.userData + "/icons");
    fs.ensureDirSync(iconDir);
    try {
        fs.accessSync(slash.join(iconDir, 'clippo.png'), fs.R_OK);
    } catch (error) {
        try {
            fs.copySync(__dirname + "/../img/clippo.png", slash.join(iconDir, 'clippo.png'));
        } catch (error) {
            err = error;
            kerror("can't copy clippo icon: " + err);
        }
    }
    return watchClipboard();
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZVJvb3QiOiIuIiwic291cmNlcyI6WyIiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7Ozs7OztBQUFBLElBQUE7O0FBUUEsTUFBd0YsT0FBQSxDQUFRLEtBQVIsQ0FBeEYsRUFBRSxlQUFGLEVBQVEseUJBQVIsRUFBbUIsbUJBQW5CLEVBQTJCLGlCQUEzQixFQUFrQyxpQkFBbEMsRUFBeUMsaUJBQXpDLEVBQWdELGlCQUFoRCxFQUF1RCxlQUF2RCxFQUE2RCxhQUE3RCxFQUFrRSxXQUFsRSxFQUFzRSxXQUF0RSxFQUEwRSxtQkFBMUUsRUFBa0Y7O0FBRWxGLFFBQUEsR0FBVyxPQUFBLENBQVEsVUFBUjs7QUFDWCxHQUFBLEdBQVcsT0FBQSxDQUFRLGlCQUFSOztBQUVYLElBQUcsRUFBRSxDQUFDLFFBQUgsQ0FBQSxDQUFBLEtBQWlCLFFBQXBCO0lBQ0ksV0FBQSxHQUFjLE9BQUEsQ0FBUSxlQUFSLEVBRGxCOzs7QUFHQSxHQUFBLEdBQU0sSUFBSSxHQUFKLENBQ0Y7SUFBQSxHQUFBLEVBQVksU0FBWjtJQUNBLEdBQUEsRUFBWSxHQURaO0lBRUEsUUFBQSxFQUFZLGlCQUZaO0lBR0EsS0FBQSxFQUFZLFlBSFo7SUFJQSxJQUFBLEVBQVksZ0JBSlo7SUFLQSxJQUFBLEVBQVksb0JBTFo7SUFNQSxLQUFBLEVBQVksa0JBTlo7SUFPQSxNQUFBLEVBQWUsU0FBQTtlQUFHLElBQUEsQ0FBQTtJQUFILENBUGY7SUFRQSxhQUFBLEVBQWUsU0FBQTtlQUFHLGFBQUEsQ0FBQTtJQUFILENBUmY7SUFTQSxLQUFBLEVBQVksSUFUWjtJQVVBLE1BQUEsRUFBWSxJQVZaO0lBV0EsUUFBQSxFQUFZLEdBWFo7SUFZQSxTQUFBLEVBQVksR0FaWjtDQURFOztBQWVOLFNBQUEsR0FBZ0IsUUFBUSxDQUFDOztBQUN6QixXQUFBLEdBQWdCLFFBQVEsQ0FBQzs7QUFDekIsT0FBQSxHQUFnQjs7QUFDaEIsT0FBQSxHQUFnQjs7QUFDaEIsU0FBQSxHQUFn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WUFFTTtZQUNGLE1BQUEsQ0FBTywwQkFBQSxHQUEyQixHQUFsQyxFQUhKO1NBSEo7O1dBUUEsY0FBQSxDQUFBO0FBZmdCLENBQXBCIiwic291cmNlc0NvbnRlbnQiOlsiIyMjXG4wMCAgICAgMDAgICAwMDAwMDAwICAgMDAwICAwMDAgICAwMDBcbjAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgIDAwMDAgIDAwMFxuMDAwMDAwMDAwICAwMDAwMDAwMDAgIDAwMCAgMDAwIDAgMDAwXG4wMDAgMCAwMDAgIDAwMCAgIDAwMCAgMDAwICAwMDAgIDAwMDBcbjAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgIDAwMCAgIDAwMFxuIyMjXG5cbnsgcG9zdCwgb3Nhc2NyaXB0LCBjaGlsZHAsIGZpcnN0LCBzbGFzaCwgcHJlZnMsIGVtcHR5LCBub29uLCBhcHAsIG9zLCBmcywga2Vycm9yLCBfIH0gPSByZXF1aXJlICdreGsnXG5cbmVsZWN0cm9uID0gcmVxdWlyZSAnZWxlY3Ryb24nXG5wa2cgICAgICA9IHJlcXVpcmUgJy4uL3BhY2thZ2UuanNvbidcblxuaWYgb3MucGxhdGZvcm0oKSA9PSAnZGFyd2luJ1xuICAgIGFwcEljb25TeW5jID0gcmVxdWlyZSAnLi9hcHBpY29uc3luYydcblxuYXBwID0gbmV3IGFwcFxuICAgIGRpcjogICAgICAgIF9fZGlybmFtZVxuICAgIHBrZzogICAgICAgIHBrZ1xuICAgIHNob3J0Y3V0OiAgICdDbWRPckN0cmwrQWx0K1YnXG4gICAgaW5kZXg6ICAgICAgJ2luZGV4Lmh0bWwnXG4gICAgaWNvbjogICAgICAgJy4uL2ltZy9hcHAuaWNvJ1xuICAgIHRyYXk6ICAgICAgICcuLi9pbWcvbWVudUAyeC5wbmcnXG4gICAgYWJvdXQ6ICAgICAgJy4uL2ltZy9hYm91dC5wbmcnXG4gICAgb25RdWl0OiAgICAgICAgLT4gcXVpdCgpXG4gICAgb25XaWxsU2hvd1dpbjogLT4gb25XaWxsU2hvd1dpbigpXG4gICAgd2lkdGg6ICAgICAgMTAwMFxuICAgIGhlaWdodDogICAgIDEyMDBcbiAgICBtaW5XaWR0aDogICAzMDBcbiAgICBtaW5IZWlnaHQ6ICAyMDBcblxuY2xpcGJvYXJkICAgICA9IGVsZWN0cm9uLmNsaXBib2FyZFxubmF0aXZlSW1hZ2UgICA9IGVsZWN0cm9uLm5hdGl2ZUltYWdlXG5idWZmZXJzICAgICAgID0gW11cbmljb25EaXIgICAgICAgPSBcIlwiXG5hY3RpdmVBcHAgICAgID0gXCJcIlxub3JpZ2luQXBwICAgICA9IG51bGxcbmNsaXBwb1dhdGNoICAgPSBudWxsXG5hcHBOYW1lICAgICAgID0gJ2NsaXBwbydcblxuIyAwMDAwMDAwMCAgICAwMDAwMDAwICAgIDAwMDAwMDAgIDAwMDAwMDAwMFxuIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgICAgIDAwMFxuIyAwMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwMDAwMCAgICAgIDAwMFxuIyAwMDAgICAgICAgIDAwMCAgIDAwMCAgICAgICAwMDAgICAgIDAwMFxuIyAwMDAgICAgICAgICAwMDAwMDAwICAgMDAwMDAwMCAgICAgIDAwMFxuXG5wb3N0Lm9uICdwYXN0ZScsICAgICAgKGluZGV4KSAtPiBwYXN0ZUluZGV4IGluZGV4XG5wb3N0Lm9uICdkZWwnLCAgICAgICAgKGluZGV4KSAtPiBkZWxldGVJbmRleCBpbmRleFxucG9zdC5vbkdldCAnYnVmZmVycycsICgpICAgICAgLT4gYnVmZmVyc1xucG9zdC5vbiAnY2xlYXJCdWZmZXInLCAtPiBjbGVhckJ1ZmZlcigpXG5wb3N0Lm9uICdzYXZlQnVmZmVyJywgIC0+IHNhdmVCdWZmZXIoKVxuXG4jIDAwMDAwMDAgICAgMDAwMDAwMCAgMDAwMDAwMDAwICAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDBcbiMwMDAgICAwMDAgIDAwMCAgICAgICAgICAwMDAgICAgIDAwMCAgMDAwICAgMDAwICAwMDBcbiMwMDAwMDAwMDAgIDAwMCAgICAgICAgICAwMDAgICAgIDAwMCAgIDAwMCAwMDAgICAwMDAwMDAwXG4jMDAwICAgMDAwICAwMDAgICAgICAgICAgMDAwICAgICAwMDAgICAgIDAwMCAgICAgMDAwXG4jMDAwICAgMDAwICAgMDAwMDAwMCAgICAgMDAwICAgICAwMDAgICAgICAwICAgICAgMDAwMDAwMDBcblxuZ2V0QWN0aXZlQXBwID0gLT5cblxuICAgIGlmIG9zLnBsYXRmb3JtKCkgPT0gJ3dpbjMyJ1xuICAgICAgICB3eHcgPSByZXF1aXJlICd3eHcnXG4gICAgICAgIGluZm8gPSBmaXJzdCB3eHcgJ2luZm8nICd0b3AnXG4gICAgICAgICMga2xvZyAnZ2V0QWN0aXZlQXBwJyBpbmZvXG4gICAgICAgIGFwcE5hbWUgPSBzbGFzaC5iYXNlIGluZm8ucGF0aFxuICAgIGVsc2UgaWYgb3MucGxhdGZvcm0oKSA9PSAnZGFyd2luJ1xuICAgICAgICBzY3JpcHQgPSBvc2FzY3JpcHQgXCJcIlwiXG4gICAgICAgIHRlbGwgYXBwbGljYXRpb24gXCJTeXN0ZW0gRXZlbnRzXCJcbiAgICAgICAgICAgIHNldCBuIHRvIG5hbWUgb2YgZmlyc3QgYXBwbGljYXRpb24gcHJvY2VzcyB3aG9zZSBmcm9udG1vc3QgaXMgdHJ1ZVxuICAgICAgICBlbmQgdGVsbFxuICAgICAgICBkbyBzaGVsbCBzY3JpcHQgXCJlY2hvIFwiICYgblxuICAgICAgICBcIlwiXCJcbiAgICAgICAgYXBwTmFtZSA9IGNoaWxkcC5leGVjU3luYyBcIm9zYXNjcmlwdCAje3NjcmlwdH1cIlxuICAgICAgICBhcHBOYW1lID0gU3RyaW5nKGFwcE5hbWUpLnRyaW0oKVxuICAgIGFwcE5hbWVcblxuIyAwMDAwMDAwICAgMDAwMDAwMDAgICAwMDAwMDAwMCAgIDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwXG4jMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAwMDAgICAgICAgMDAwICAgMDAwICAwMDAwICAwMDBcbiMwMDAwMDAwMDAgIDAwMDAwMDAwICAgMDAwMDAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAwIDAwMFxuIzAwMCAgIDAwMCAgMDAwICAgICAgICAwMDAgICAgICAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAwMDAwXG4jMDAwICAgMDAwICAwMDAgICAgICAgIDAwMCAgICAgICAgMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDBcblxuc2F2ZUFwcEljb24gPSAoYXBwTmFtZSkgLT5cblxuICAgIGljb25QYXRoID0gXCIje2ljb25EaXJ9LyN7YXBwTmFtZX0ucG5nXCJcbiAgICBpZiBub3Qgc2xhc2guaXNGaWxlIGljb25QYXRoXG4gICAgICAgIHBuZyA9IGFwcEljb25TeW5jIGFwcE5hbWUsIGljb25EaXIsIDEyOFxuICAgICAgICBhcHBOYW1lID0gXCJjbGlwcG9cIiBpZiBub3QgcG5nXG4gICAgYXBwTmFtZVxuXG5vbldpbGxTaG93V2luID0gLT5cbiAgICBcbiAgICBhY3RpdmVBcHAgPSBnZXRBY3RpdmVBcHAoKVxuICAgIFxuIyAwMDAgICAwMDAgIDAwMCAgMDAwICAgMDAwICAgICAgICAwMDAgICAwMDAgICAwMDAwMDAwICAgMDAwMDAwMDAwICAgMDAwMDAwMCAgMDAwICAgMDAwICBcbiMgMDAwIDAgMDAwICAwMDAgIDAwMDAgIDAwMCAgICAgICAgMDAwIDAgMDAwICAwMDAgICAwMDAgICAgIDAwMCAgICAgMDAwICAgICAgIDAwMCAgIDAwMCAgXG4jIDAwMDAwMDAwMCAgMDAwICAwMDAgMCAwMDAgICAgICAgIDAwMDAwMDAwMCAgMDAwMDAwMDAwICAgICAwMDAgICAgIDAwMCAgICAgICAwMDAwMDAwMDAgIFxuIyAwMDAgICAwMDAgIDAwMCAgMDAwICAwMDAwICAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgICAgMDAwICAgICAwMDAgICAgICAgMDAwICAgMDAwICBcbiMgMDAgICAgIDAwICAwMDAgIDAwMCAgIDAwMCAgICAgICAgMDAgICAgIDAwICAwMDAgICAwMDAgICAgIDAwMCAgICAgIDAwMDAwMDAgIDAwMCAgIDAwMCAgXG5cbndpbkNsaXBib2FyZENoYW5nZWQgPSAtPlxuXG4gICAgd3h3ID0gcmVxdWlyZSAnd3h3J1xuICAgIGFwcE5hbWUgPSAnY2xpcHBvJ1xuICAgIFxuICAgIHdpbkluZm8gPSBmaXJzdCB3eHcgJ2luZm8nICd0b3AnXG5cbiAgICBhcHBOYW1lID0gc2xhc2guYmFzZSB3aW5JbmZvLnBhdGhcbiAgICBleGNsdWRlID0gcHJlZnMuZ2V0ICdleGNsdWRlJyBbJ3Bhc3N3b3JkLXR1cnRsZSddXG4gICAgaWYgbm90IGVtcHR5IGV4Y2x1ZGVcbiAgICAgICAgZm9yIGV4YXBwIGluIGV4Y2x1ZGVcbiAgICAgICAgICAgIHJldHVybiBpZiBhcHBOYW1lLnN0YXJ0c1dpdGggZXhhcHBcbiAgICBpY29uUGF0aCA9IFwiI3tpY29uRGlyfS8je2FwcE5hbWV9LnBuZ1wiXG4gICAgaWYgbm90IHNsYXNoLmlzRmlsZSBpY29uUGF0aFxuICAgICAgICB3eHcgJ2ljb24nIHdpbkluZm8ucGF0aCwgaWNvblBhdGhcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgb25DbGlwYm9hcmRDaGFuZ2VkKClcblxubWFjQ2xpcGJvYXJkQ2hhbmdlZCA9IC0+XG5cbiAgICBjdXJyZW50QXBwID0gZ2V0QWN0aXZlQXBwKClcbiAgICBjdXJyZW50QXBwID0gJ2NsaXBwbycgaWYgY3VycmVudEFwcC50b0xvd2VyQ2FzZSgpID09ICdlbGVjdHJvbidcbiAgICBvcmlnaW5BcHAgID0gJ2NsaXBwbycgaWYgKG5vdCBvcmlnaW5BcHApIGFuZCAobm90IGN1cnJlbnRBcHApXG5cbiAgICBzYXZlQXBwSWNvbiBvcmlnaW5BcHAgPyBjdXJyZW50QXBwXG5cbiAgICBvbkNsaXBib2FyZENoYW5nZWQoKVxuICAgIFxub25DbGlwYm9hcmRDaGFuZ2VkID0gLT5cblxuICAgIGZvciBmb3JtYXQgaW4gY2xpcGJvYXJkLmF2YWlsYWJsZUZvcm1hdHMoKVxuXG4gICAgICAgIGlmIGZvcm1hdC5zdGFydHNXaXRoICdpbWFnZS8nXG5cbiAgICAgICAgICAgIGltYWdlQnVmZmVyID0gY2xpcGJvYXJkLnJlYWRJbWFnZSgpLnRvUE5HKClcbiAgICAgICAgICAgIGltYWdlRGF0YSAgID0gaW1hZ2VCdWZmZXIudG9TdHJpbmcoJ2Jhc2U2NCcpXG5cbiAgICAgICAgICAgIGZvciBiIGluIGJ1ZmZlcnNcbiAgICAgICAgICAgICAgICBpZiBiLmltYWdlPyBhbmQgYi5pbWFnZSA9PSBpbWFnZURhdGFcbiAgICAgICAgICAgICAgICAgICAgYXBwTmFtZSA9IGIuYXBwXG4gICAgICAgICAgICAgICAgICAgIF8ucHVsbCBidWZmZXJzLCBiXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrXG5cbiAgICAgICAgICAgIGJ1ZmZlcnMucHVzaFxuICAgICAgICAgICAgICAgIGFwcDogICBhcHBOYW1lXG4gICAgICAgICAgICAgICAgaW1hZ2U6IGltYWdlRGF0YVxuICAgICAgICAgICAgICAgIGNvdW50OiBidWZmZXJzLmxlbmd0aFxuXG4gICAgICAgICAgICByZWxvYWQgYnVmZmVycy5sZW5ndGgtMVxuICAgICAgICAgICAgcmV0dXJuXG5cbiAgICB0ZXh0ID0gY2xpcGJvYXJkLnJlYWRUZXh0KClcblxuICAgIGlmIHRleHQubGVuZ3RoIGFuZCB0ZXh0LnRyaW0oKS5sZW5ndGhcblxuICAgICAgICBmb3IgYiBpbiBidWZmZXJzXG4gICAgICAgICAgICBpZiBiLnRleHQ/IGFuZCBiLnRleHQgPT0gdGV4dFxuICAgICAgICAgICAgICAgIGFwcE5hbWUgPSBiLmFwcFxuICAgICAgICAgICAgICAgIF8ucHVsbCBidWZmZXJzLCBiXG4gICAgICAgICAgICAgICAgYnJlYWtcblxuICAgICAgICBidWZmZXJzLnB1c2hcbiAgICAgICAgICAgIGFwcDogICBhcHBOYW1lXG4gICAgICAgICAgICB0ZXh0OiAgdGV4dFxuICAgICAgICAgICAgY291bnQ6IGJ1ZmZlcnMubGVuZ3RoLTFcblxuICAgICAgICByZWxvYWQgYnVmZmVycy5sZW5ndGgtMVxuXG53YXRjaENsaXBib2FyZCA9IC0+XG4gICAgXG4gICAgY3cgPSByZXF1aXJlICdlbGVjdHJvbi1jbGlwYm9hcmQtd2F0Y2hlcidcblxuICAgIGlmIG9zLnBsYXRmb3JtKCkgPT0gJ3dpbjMyJ1xuICAgICAgICBjdyB3YXRjaERlbGF5OjIwMCwgb25JbWFnZUNoYW5nZTp3aW5DbGlwYm9hcmRDaGFuZ2VkLCBvblRleHRDaGFuZ2U6d2luQ2xpcGJvYXJkQ2hhbmdlZFxuICAgIGVsc2VcbiAgICAgICAgY3cgd2F0Y2hEZWxheToyMDAsIG9uSW1hZ2VDaGFuZ2U6bWFjQ2xpcGJvYXJkQ2hhbmdlZCwgb25UZXh0Q2hhbmdlOm1hY0NsaXBib2FyZENoYW5nZWRcblxuIyAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAwICAgMDAwICAgMDAwXG4jMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgMDAwIDAwMFxuIzAwMCAgICAgICAwMDAgICAwMDAgIDAwMDAwMDAwICAgICAwMDAwMFxuIzAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgICAgICAgICAgMDAwXG4jIDAwMDAwMDAgICAwMDAwMDAwICAgMDAwICAgICAgICAgICAwMDBcblxuY29weUluZGV4ID0gKGluZGV4KSAtPlxuXG4gICAgcmV0dXJuIGlmIChpbmRleCA8IDApIG9yIChpbmRleCA+IGJ1ZmZlcnMubGVuZ3RoLTEpXG4gICAgaWYgYnVmZmVyc1tpbmRleF0uaW1hZ2VcbiAgICAgICAgaW1hZ2UgPSBuYXRpdmVJbWFnZS5jcmVhdGVGcm9tQnVmZmVyIG5ldyBCdWZmZXIgYnVmZmVyc1tpbmRleF0uaW1hZ2UsICdiYXNlNjQnXG4gICAgICAgIGlmIG5vdCBpbWFnZS5pc0VtcHR5KCkgYW5kIChpbWFnZS5nZXRTaXplKCkud2lkdGggKiBpbWFnZS5nZXRTaXplKCkuaGVpZ2h0ID4gMClcbiAgICAgICAgICAgIGNsaXBib2FyZC53cml0ZUltYWdlIGltYWdlLCAgJ2ltYWdlL3BuZydcbiAgICBpZiBidWZmZXJzW2luZGV4XS50ZXh0PyBhbmQgKGJ1ZmZlcnNbaW5kZXhdLnRleHQubGVuZ3RoID4gMClcbiAgICAgICAgY2xpcGJvYXJkLndyaXRlVGV4dCBidWZmZXJzW2luZGV4XS50ZXh0LCAndGV4dC9wbGFpbidcblxuIzAwMDAwMDAwICAgIDAwMDAwMDAgICAgMDAwMDAwMCAgMDAwMDAwMDAwICAwMDAwMDAwMFxuIzAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgICAgMDAwICAgICAwMDBcbiMwMDAwMDAwMCAgIDAwMDAwMDAwMCAgMDAwMDAwMCAgICAgIDAwMCAgICAgMDAwMDAwMFxuIzAwMCAgICAgICAgMDAwICAgMDAwICAgICAgIDAwMCAgICAgMDAwICAgICAwMDBcbiMwMDAgICAgICAgIDAwMCAgIDAwMCAgMDAwMDAwMCAgICAgIDAwMCAgICAgMDAwMDAwMDBcblxucGFzdGVJbmRleCA9IChpbmRleCkgLT5cblxuICAgIGNvcHlJbmRleCBpbmRleFxuICAgIG9yaWdpbkFwcCA9IGJ1ZmZlcnMuc3BsaWNlKGluZGV4LCAxKVswXT8uYXBwXG5cbiAgICBpZiBvcy5wbGF0Zm9ybSgpID09ICd3aW4zMidcbiAgICAgICAgd3h3ID0gcmVxdWlyZSAnd3h3J1xuICAgICAgICBwYXN0ZSA9IC0+XG4gICAgICAgICAgICBpZiBhY3RpdmVBcHAgPT0gJ21pbnR0eSdcbiAgICAgICAgICAgICAgICB3eHcgJ2tleScgJ2N0cmwrc2hpZnQrdidcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICB3eHcgJ2tleScgJ2N0cmwrdidcbiAgICAgICAgYXBwLndpbi5jbG9zZSgpXG4gICAgICAgIHNldFRpbWVvdXQgcGFzdGUsIDIwXG4gICAgZWxzZSBpZiBvcy5wbGF0Zm9ybSgpICE9ICdkYXJ3aW4nXG4gICAgICAgIGNoaWxkcC5leGVjU3luYyBcIm9zYXNjcmlwdCBcIiArIG9zYXNjcmlwdCBcIlwiXCJcbiAgICAgICAgICAgIHRlbGwgYXBwbGljYXRpb24gXCJTeXN0ZW0gRXZlbnRzXCIgdG8ga2V5c3Ryb2tlIHRhYiB1c2luZyBjb21tYW5kIGRvd25cbiAgICAgICAgXCJcIlwiXG4gICAgICAgIGNoaWxkcC5leGVjU3luYyBcIm9zYXNjcmlwdCBcIiArIG9zYXNjcmlwdCBcIlwiXCJcbiAgICAgICAgICAgIHRlbGwgYXBwbGljYXRpb24gXCJTeXN0ZW0gRXZlbnRzXCIgdG8ga2V5c3Ryb2tlIFwidlwiIHVzaW5nIGNvbW1hbmQgZG93blxuICAgICAgICBcIlwiXCJcblxuIzAwMDAwMDAgICAgMDAwMDAwMDAgIDAwMFxuIzAwMCAgIDAwMCAgMDAwICAgICAgIDAwMFxuIzAwMCAgIDAwMCAgMDAwMDAwMCAgIDAwMFxuIzAwMCAgIDAwMCAgMDAwICAgICAgIDAwMFxuIzAwMDAwMDAgICAgMDAwMDAwMDAgIDAwMDAwMDBcblxuZGVsZXRlSW5kZXggPSAoaW5kZXgpIC0+XG5cbiAgICBidWZmZXJzLnNwbGljZSBpbmRleCwgMVxuICAgIHJlbG9hZCBpbmRleC0xXG5cbnF1aXQgPSAtPlxuXG4gICAgc2F2ZUJ1ZmZlcigpXG4gICAgY2xpcHBvV2F0Y2g/LmtpbGwoKVxuXG5yZWxvYWQgPSAoaW5kZXg9MCkgLT5cblxuICAgIHBvc3QudG9XaW5zICdsb2FkQnVmZmVycycsIGJ1ZmZlcnMsIGluZGV4XG5cbmNsZWFyQnVmZmVyID0gLT5cblxuICAgIGJ1ZmZlcnMgPSBbXVxuICAgIHNhdmVCdWZmZXIoKVxuICAgIHJlbG9hZCgpXG5cbnNhdmVCdWZmZXIgPSAtPlxuXG4gICAgbm9vbi5zYXZlIFwiI3thcHAudXNlckRhdGF9L2J1ZmZlcnMubm9vblwiLCBidWZmZXJzLnNsaWNlKC0gcHJlZnMuZ2V0KCdtYXhCdWZmZXJzJywgNTApKVxuXG5yZWFkQnVmZmVyID0gLT5cblxuICAgIHRyeVxuICAgICAgICBidWZmZXJzID0gbm9vbi5sb2FkIHNsYXNoLnBhdGggXCIje2FwcC51c2VyRGF0YX0vYnVmZmVycy5ub29uXCJcbiAgICAgICAgYnVmZmVycyA9IGJ1ZmZlcnMgPyBbXVxuICAgIGNhdGNoXG4gICAgICAgIGJ1ZmZlcnMgPSBbXVxuXG4jMDAwMDAwMDAgICAwMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwICAgIDAwMCAgIDAwMFxuIzAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgMDAwIDAwMFxuIzAwMDAwMDAgICAgMDAwMDAwMCAgIDAwMDAwMDAwMCAgMDAwICAgMDAwICAgIDAwMDAwXG4jMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgICAgIDAwMFxuIzAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMCAgICAgICAwMDBcblxucG9zdC5vbiAnYXBwUmVhZHknLCAtPlxuXG4gICAgcmVhZEJ1ZmZlcigpXG5cbiAgICBpY29uRGlyID0gc2xhc2gucmVzb2x2ZSBcIiN7YXBwLnVzZXJEYXRhfS9pY29uc1wiXG4gICAgZnMuZW5zdXJlRGlyU3luYyBpY29uRGlyXG5cbiAgICB0cnlcbiAgICAgICAgZnMuYWNjZXNzU3luYyBzbGFzaC5qb2luKGljb25EaXIsICdjbGlwcG8ucG5nJyksIGZzLlJfT0tcbiAgICBjYXRjaFxuICAgICAgICB0cnlcbiAgICAgICAgICAgIGZzLmNvcHlTeW5jIFwiI3tfX2Rpcm5hbWV9Ly4uL2ltZy9jbGlwcG8ucG5nXCIsIHNsYXNoLmpvaW4gaWNvbkRpciwgJ2NsaXBwby5wbmcnXG4gICAgICAgIGNhdGNoIGVyclxuICAgICAgICAgICAga2Vycm9yIFwiY2FuJ3QgY29weSBjbGlwcG8gaWNvbjogI3tlcnJ9XCJcblxuICAgIHdhdGNoQ2xpcGJvYXJkKClcbiJdfQ==
//# sourceURL=../coffee/main.coffee